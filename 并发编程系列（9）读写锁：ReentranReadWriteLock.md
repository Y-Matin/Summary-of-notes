<!-- ## 并发编程系列（9）读写锁：ReentranReadWriteLock -->

- **特性**： 写写互斥、读写互斥、读读共享
- **锁降级**： 线程获取写入锁否，可以获取读取锁，然后释放写入锁，这样就从写入锁变成了读取锁，实现锁的降级
  
### 源码解析
####  用单一int型state表示读写两种状态
- int 是32位的，在逻辑上将其拆分为两个无符号的short型
  ``` xml
    高16位表示读锁               低16位表示写锁
   0000 0000 0000 0000         0000 0000 0000 0000  
   -------------------------------------------
   所以两个锁最大的重入次数为 <1111 1111 1111 1111> 即2^16 -1 = 65525
   -------------------------------------------
   读锁：获取读锁成功后，在当前状态上加<1 0000 0000 0000 0000> 即 2^16 = 65526
   从 0000 0000 0000 0000   0000 0000 0000 0000
   到 0000 0000 0000 0001   0000 0000 0000 0000
   所以计算读锁的次数逻辑为：将state右移16位
   --------------------------------------------
   写锁：获取写锁成功后，在当前状态上加1
   从 0000 0000 0000 0000   0000 0000 0000 0000
   到 0000 0000 0000 0000   0000 0000 0000 0001
   所以计算写锁的次数逻辑为：将state 与 上 <1111 1111 1111 1111> 65525
        具体如下：
        0000 0000 0000 0001     0000 0000 0000 0011
                            &
        0000 0000 0000 0000     1111 1111 1111 1111
        结果为：==>>
        0000 0000 0000 0000     0000 0000 0000 0011
        
  ```
-
 